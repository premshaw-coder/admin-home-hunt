<div class="card">
    <form [formGroup]="RentPropertyListingForm">
        <p-stepper [value]="1" [linear]="true">
            <p-step-item [value]="1">
                <p-step>Property Address</p-step>
                <p-step-panel>
                    <ng-template #content let-activateCallback="activateCallback">
                        <div formGroupName="propertyFullAddress" class="flex_row flex-wrap flex_gap">
                            @for (formData of propertyFullAddressFormData; track formData?.id) {
                            <div>
                                @let formControl
                                =RentPropertyListingForm.get('propertyFullAddress')?.get(formData.control);
                                <input [placeholder]="formData.placeholder" type="text" pInputText
                                    [formControlName]="formData.control"
                                    [ngClass]="{'ng-invalid ng-dirty': formControl?.touched && formControl?.invalid}" />
                            </div>
                            }
                            <button pButton icon="pi pi-map-marker" [severity]="severity" [label]="accuracyLabel"
                                (click)="locateMe(); accuracyLabel = 'Locating'"
                                [disabled]="accuracy < 200 || accuracyLabel == 'Locating'">
                            </button>
                        </div>
                        <div class="py-6" style="margin: 24px 0px 0px 0px;">
                            <p-button [disabled]="RentPropertyListingForm.get('propertyFullAddress')?.invalid"
                                [style]="{'margin-top': '16px'}" label="Next" (onClick)="activateCallback(2)" />
                        </div>
                    </ng-template>
                </p-step-panel>
            </p-step-item>

            <p-step-item [value]="2">
                <p-step>Property Details</p-step>
                <p-step-panel>
                    <ng-template #content let-activateCallback="activateCallback">
                        <div formGroupName="propertyDetails" class="flex_row flex-wrap flex_gap">
                            @for (formData of propertyDetailsFormInputData; track formData?.id) {
                            <div>
                                <input [placeholder]="formData.placeholder" type="text" pInputText
                                    [formControlName]="formData.control" />
                            </div>
                            }
                            @for (propertyDetailsFormSelect of propertyDetailsFormSelectData; track
                            propertyDetailsFormSelect.id) {
                            <div>
                                <p-select appendTo="body" [formControlName]="propertyDetailsFormSelect.control"
                                    [options]="propertyDetailsFormSelect.values" optionLabel="name" optionValue="code"
                                    [placeholder]="propertyDetailsFormSelect.placeholder" class="w-full md:w-56">
                                </p-select>
                            </div>
                            }
                        </div>
                        <div class="flex py-6 gap-2" style="margin: 24px 0px 0px 0px;">
                            <p-button [style]="{'margin-right': '12px',}" label="Back" severity="secondary"
                                (onClick)="activateCallback(1)" />
                            <p-button [disabled]="RentPropertyListingForm.get('propertyDetails')?.invalid" label="Next"
                                (onClick)="updateValidator(true); activateCallback(3)" />
                        </div>
                    </ng-template>
                </p-step-panel>
            </p-step-item>

            <p-step-item [value]="3">
                <p-step>Property Amenities & Others</p-step>
                <p-step-panel>
                    <ng-template #content let-activateCallback="activateCallback">
                        <div class="flex_row flex-wrap flex_gap">
                            <div formGroupName="propertyAmnities">
                                <p-multiselect formControlName="amnities" appendTo="body"
                                    [options]="propertyAmenitiesValues" placeholder="Select Amnities" optionLabel="name"
                                    optionValue="code" display="chip" class="w-full md:w-96" />
                            </div>
                            <div formGroupName="propertyDetails" class="flex_gap">
                                <input placeholder="Enter YouTube Link" type="text" pInputText
                                    formControlName="propertyYouTubeLink" class="w-full md:w-96" />
                                <!-- <p-select formControlName="visitingStartTime" appendTo="body" [options]="propertyVisitingFormSelectData"
                                    placeholder="Select Amnities" optionLabel="name" optionValue="code"
                                    class="w-full md:w-96" />
                                <p-select formControlName="visitingEndTime" appendTo="body" [options]="testTime(false)"
                                    placeholder="Select Amnities" optionLabel="name" optionValue="code"
                                    class="w-full md:w-96" /> -->
                            </div>
                            <div formGroupName="propertyDetails" class="flex_row flex-wrap flex_gap flex-grow-1">
                                @for (propertyDetailsFormSelect of propertyVisitingFormSelectData; track
                                propertyDetailsFormSelect.id) {
                                <div>
                                    <p-select appendTo="body" [formControlName]="propertyDetailsFormSelect.control"
                                        [options]="propertyDetailsFormSelect.values" optionLabel="name"
                                        optionValue="code" [placeholder]="propertyDetailsFormSelect.placeholder"
                                        (onChange)="getTime(propertyDetailsFormSelect.control)" class="w-full md:w-56">
                                    </p-select>
                                </div>
                                }
                            </div>
                        </div>
                        <div class="py-6">
                            <p-button [style]="{'margin-top': '16px', 'margin-right':'12px'}" label="Back"
                                severity="secondary" (onClick)="updateValidator(false); activateCallback(2)" />
                            <p-button
                                [disabled]="RentPropertyListingForm.get('propertyAmnities')?.invalid || RentPropertyListingForm.get('propertyDetails')?.invalid"
                                label="Submit" (onClick)="onSubmit();activateCallback(3)" />
                        </div>
                    </ng-template>
                </p-step-panel>
            </p-step-item>
        </p-stepper>
    </form>
</div>